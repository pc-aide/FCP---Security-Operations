<div>
  <h2>Question 9</h2>
  <p>What are the two results of this configuration? (Choose two.)</p>
  <pre>
  config system settings
  set ses-denied-traffic enable
  end
  config system global
  set block-session-timer 30
  end
    </pre>

  <form>
    <div>
      <input type="checkbox" name="deniedTrafficResults" value="A" id="optionA_9">
      <label for="optionA_9">A. Denied users are blocked for 30 minutes.</label><br>

      <input type="checkbox" name="deniedTrafficResults" value="B" id="optionB_9">
      <label for="optionB_9">B. A session for denied traffic is created.</label><br>

      <input type="checkbox" name="deniedTrafficResults" value="C" id="optionC_9">
      <label for="optionC_9">C. The number of logs generated by denied traffic is reduced.</label><br>

      <input type="checkbox" name="deniedTrafficResults" value="D" id="optionD_9">
      <label for="optionD_9">D. Device detection on all interfaces is enforced for 30 minutes.</label><br>
    </div>
  </form>

  <button class="solutionButton" data-answer-name="question9">Solution</button>

  <div id="solutionInfo_question9" class="solutionInfo" style="display: none;">
    <p><strong>Explanation:</strong></p>
    <img src="https://github.com/pc-aide/FCP-SO/blob/main/edu/PreExam/AD/Q4/img/q9_3.png?raw=true">
    <p>
      FortiGate Security 7.2 Study Guide (p.69):
"During the session, if a security profile detects a violation, FortiGate records the attack log immediately. To reduce the number of log messages generated and improve performance, you can enable a session table entry of dropped traffic. This creates the denied session in the session table and, if the session is denied, all packets of that session are also denied. This ensures that FortiGate does not have to do a policy lookup for each new packet matching the denied session, which reduces CPU usage and log generation.
This option is in the CLI, and is called ses-denied-traffic. You can also set the duration for block sessions. This determines how long a session will be kept in the session table by setting block-sessiontimer in the CLI. By default, it is set to 30 seconds."
    </p>
    <p>this is because during the session, if a security profile detects a violation, FortiGate records the attack log immediately. To
      reduce the number of log messages generated and improve performance you can use the ses-denied-traffic command this puts creates a denied session entry for <x> number of SECONDS.</p>
    <img src="https://raw.githubusercontent.com/pc-aide/FCP-SO/refs/heads/main/edu/PreExam/AD/Q4/img/q9_2.png">
    <p>B. The <code>ses-denied-traffic</code> enable setting enables session creation for denied traffic, helping track and analyze it.</p>
    <p>C. By adjusting the global <code>block-session-timer</code>, blocking denied session packets can take more CPU resources than passing them, thus reducing log generation.</p>
    
    <p><strong>References:</strong></p>
    <ul>
      <li><a href="https://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-enable-denied-session-to-be-added-into-the/ta-p/195478" target="_blank">Fortinet Community - Enabling Denied Sessions</a></li>
      <li><a href="https://docs.fortinet.com/document/fortigate/7.2.5/fortinet-carrier-grade-nat-field-reference-architecture-guide/400389/session-timers" target="_blank">Fortinet Documentation - Session Timers</a></li>
      <li><a href="https://ebin.pub/fortinet-fortigate-security-study-guide-for-fortios-72.html" target="_blank">Fortinet Security Study Guide for FortiOS 7.2 - pdf</a></li>
      <li><a href="https://docs.fortinet.com/document/fortigate/7.4.2/cli-reference/2620/config-system-global" target="_blank">Fortinet CLI Reference</a></li>
    </ul>

    <p id="correctAnswers_question9" style="display: none;">
      <strong>Correct Answers:</strong><br>
      B. A session for denied traffic is created.<br>
      C. The number of logs generated by denied traffic is reduced.
    </p>
  </div>
</div>

<script src="../Scripts/answer9.js"></script>
